apiVersion: postgresql.cnpg.io/v1
kind: Cluster
metadata:
  name: authentik-postgres
spec:
  instances: {{ .Values.database.replicas }}

  postgresql:
    parameters:
      pgaudit.log: "all, -misc"
      pgaudit.log_catalog: "off"
      pgaudit.log_parameter: "on"
      pgaudit.log_relation: "on"

  storage:
    size: {{ .Values.database.size }}

{{/*  backup:*/}}
{{/*    retentionPolicy: "5d"*/}}
{{/*    barmanObjectStore:*/}}
{{/*      destinationPath: s3://cnpg/authentik*/}}
{{/*      endpointURL: http://minio.minio*/}}
{{/*      s3Credentials:*/}}
{{/*        accessKeyId:*/}}
{{/*          name: minio-credentials*/}}
{{/*          key: MINIO_ACCESS_KEY*/}}
{{/*        secretAccessKey:*/}}
{{/*          name: minio-credentials*/}}
{{/*          key: MINIO_SECRET_KEY*/}}
