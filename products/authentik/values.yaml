database:
  replicas: 3
  size: 16Gi
  monitoring:
    enabled: true
  backups:
    enabled: true
    retention: '5d'
    path: s3://cnpg/authentik
    endpoint: http://minio.minio
    sealedCredentials:
      accessKey: AgClNwoq6gBmHgIs/2LN65uUuBdtBmUDWBg2ybZuqkTVXsFpGpxNV9pv4G9nPBqZZ4kIyaAx0Mi1BEIvjKzOBo4W06pCLCnNo/9EGxC9A9iCAits5qx50u0lSjFSpfy4D9a/PdscIQOs3iuMf2hgQMixCUS6RpYs8tVNkE3H9WpCRAuVI2Zjv9CFUYOTODETkjI82Uddp3pxIWiiGP+7JLcMwiFJZ3T45x75+V25Q67tkvb0GcWVAm1ru5HdBduWDo7rqV+SrHvAAeOR0v8RIzBrMQNlbDV7d2hz8q7Qv83ggKrhnnyxzpwjApCXhh9VFF+REmYphKc8/KPvfwdLbz4HCQEXj0Hh/NE/J0N7CowQ/9VwjAY3ttbV7r0Qf/xOePaIgWBuFk+7UxHbLOhAYwjOEGyaIQFTf0Goig6nZHZ1ehQus9gVMk3yqVpXW+puQiKiw7gZ+sGl/9myehsC/FF+sBnybHvWkURZaIvwZgAd229SJyWGCzZ58x3cWEysEaAvCYf+nK2I293MUWI+69WHIKXd/Nw5BR24tFDG6pq4sYyXsURggb9k7Vbjm0xJAedysH+yl6mv6sobZh3WsWraBxsY7wmnPnJsRZzPRejfFOKvNSC0Adnyeyxce0Aex2oZrSHdykqQcckaoKhCEVMILfJ7Oxf+zst3hZL+yBob+MFLZEUBfzj/47SLO4R/m9BUa2zn
      secretKey: AgCZA4IpcCpM5SLCThnERkRK4iMRLfHVks2excpr64BXFMmZGghyDW5pSRRMJitaYs15AQC/VshBpayy730I1TyCGbD03f3Zvb62UprxLSqjtCwCog+hEtOnqQkfwMtIiNN7gVVb79dsgeufkW7zdL9e7wc97bR/I4T3om+rb0dOOU8gpcWVpMywiniix0SpuR3oBN9aAEnY2kZX1DkXzkMQvqsf+lZKItKtLGBQDrxeMbt1y/RAigozKTTg+yp09i/Mg70Y+vm5NfdkVBAj8j6sDng5TRqd6lEXuI7TMIk9x4mMLGI7IwWPxnNk4urh3tCReKaiSQ7xmMbCnGO4vns+gxEGu/4tvm6iM0voe1V6bBAiwNOOCNmYfhwlkrOunB9Xq/L292f6RIRLpAdMN5oAzIJX/xqb3LBPY92JxCShrhKCgmJ48xXf1D9HioVDUDz3z3lRsgj5bQ3M5JZBh9NI743EfCAjjW6UOH/we64F91n3kjHBljqoP1t320IKA7fQb2nsNCFVTbv24DWcKSfCDj4WSgiHctwFc07aZ1u/7zviTB/Lr4G35qPEuuTWI0yXfwqb7wuN9wbwGDtielJiSIhqbQzEbK9aXYWiVQZUgZDz2RoX0aeLMhdqUniYywPG9kCI540ppseDM4LrP0B1ZIVGGfMGJx0hp/M4XS9VIm8+QMFTa3DlJOLoQz0ESVuYhI1gi0O2gzq722/DQhtphKbGbHDOoWLLoGLrCgYjUg==

    rbac:
      serviceAccountName: authentik-postgres


authentik:
  global:
    revisionHistoryLimit: 0
    env:
      - name: AUTHENTIK_SECRET_KEY
        valueFrom:
          secretKeyRef:
            key: secretKey
            name: authentik-secret
      - name: AUTHENTIK_POSTGRESQL__PASSWORD
        valueFrom:
          secretKeyRef:
            key: databasePassword
            name: authentik-secret

  worker:
    replicas: 3

  server:
    replicas: 3

    metrics:
      serviceMonitor:
        enabled: true

    ingress:
      enabled: true
      annotations:
        cert-manager.io/cluster-issuer: letsencrypt-dns
      hosts:
        - authentik.feddema.dev
      tls:
        - secretName: authentik-tls
          hosts:
            - authentik.feddema.dev

  authentik:
    log_level: info

    postgresql:
      host: "authentik-postgres-rw"
      name: "app"
      user: "app"
      port: 5432
    redis:
      host: "{{ .Release.Name }}-redis-master"

  prometheus:
    rules:
      enabled: true

  redis:
    enabled: true
    architecture: standalone
    auth:
      enabled: false
