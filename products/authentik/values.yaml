database:
  replicas: 3
  size: 16Gi
  monitoring:
    enabled: true
  backups:
    enabled: true
    retention: '5d'
    path: s3://cnpg/authentik
    endpoint: http://minio.minio
    sealedCredentials:
      accessKey: AgBR1m/TKghudWba7MA2PmLC3qjLuWid3d4FrpJyKWms4reneQXY2Gt3xL02u2W/yDuKqP+RI0IFb64ve+gQmcCQS6UvT/BrnHN/pSLDaYUrxEhWIQbRT2SsZjCTfWp5R3HbcOROb7frK9b+S13FCiwT/GpNRq2JAFbasNbB7zm9NpiIyFJhtsfJU4y5+oDiyXCrbItkEYKviSEjuqm5nycwbmbjxzr9qJNqucBWjs3gn0GxSsAM2ipyZ0OaogvnpUzkc7+SdLJK7AEuzBlMl5NhPy/ve9E14Q+jHx7K26MDD+EVbGJYDmgH9m015FhMTLeiYtDSaIi05C455kKbddZ7MPi+wL2NoPiibuNOMkmwzn/mj/1LaC2OwY8rFrIeOg7oMp/c+l4zgeZ+2z2MD+2xSLT7CmR0S7jsyIB6DQwUNjSky3JEOnvz6zP4z+xpTKDRHQqDu28jnXeJ3vKgCzaIXUomIzeawisvaO4HnwLvb7LNLEOZ7FCdHOUm5L4LejZK4iba8PwRCvQSlQKY8JsdSo1z5Imw0lNvrE8qtQptCIMcqHfCM2zqL4cIx++Ch170opW8M1VLuZhuulkS5y1FVqMpEvz4A5USdstc7TJgnwhLtzfuyHD19ltQONZCsDJjZTJQjQWQjiJANPdrEtciCerdQI0ydBxLwC+TNILkdnmz8wqWuU+P4BfOpxrhN8h69ioJ
      secretKey: AgDFNQGawA+vcP6n0JS7TV0zQnfsdLSp6lcwWS5ya6Svf/u8dmYtQII9UjI/ADl2+It8cQhw5f05B9Plm4Zl4CkeashABCk3ClaXoazHyyWESYn3xWJ8gkpodjVEqqu41+//hWamrA8UfR6rQ+5iY6lO6Dk//tWTo2NgmTAS9EH4osN4huOhVT0XTIHVytyw/zMoaICjJiDAw4QPMnHOGIsYu7qplehNByiu/aJ3PGMUk6ZhglK2UkLn0mCw2XLuz3LBrodMkIgN8HaoCag+L5bWNguW/XSFpsFxWk88wSrfmJSBIJAewKxaYQIjUI2BM7ObOEa8F4725DG5ynvtvpv8FXI744dvSFuRYLkf1fPRFf+tavK5tJEj6YkUdrcmXkfhGq75diZiEZ7vKNNOQBwUfDxEut8+g/Kn9LqS0Mg6xS0UFhepeHXXJpJ5B6WtAoSeLaTRlHIQYwE77vxcDBm2SKWQQsfaLEyvqO5Ty57EKIa/lWesdI0q3d0Yij2JQqdwg/bdYdGKoqPG6e0g+Ur0a+IkRmpC11n48aDdCJujhVEju8sZ3XNzEI0bnZfK7R/08cP7R6HzXyYtHi5nGgD3QkqOr3FqnK/++tqQ1Y63drQQ25kLMTFA882Qw7TeF58ytmBYkhPd48grZLhRXnzBE1KD+Ios1iIe4HulWkRvGXnjdlcSs2KdzFKxm6B8wHcDMHcIW0H2vJ+9BsWueaXI3nO8A4OjZuxNQEk2cqsSPA==

    rbac:
      serviceAccountName: authentik-postgres


authentik:
  global:
    revisionHistoryLimit: 0
    env:
      - name: AUTHENTIK_SECRET_KEY
        valueFrom:
          secretKeyRef:
            key: secretKey
            name: authentik-secret
      - name: AUTHENTIK_POSTGRESQL__PASSWORD
        valueFrom:
          secretKeyRef:
            key: databasePassword
            name: authentik-secret

  worker:
    replicas: 3

  server:
    replicas: 3

    metrics:
      serviceMonitor:
        enabled: true

    ingress:
      enabled: true
      annotations:
        cert-manager.io/cluster-issuer: letsencrypt-dns
      hosts:
        - authentik.feddema.dev
      tls:
        - secretName: authentik-tls
          hosts:
            - authentik.feddema.dev

  authentik:
    log_level: info

    postgresql:
      host: "authentik-postgres-rw"
      name: "app"
      user: "app"
      port: 5432
    redis:
      host: "{{ .Release.Name }}-redis-master"

  prometheus:
    rules:
      enabled: true

  redis:
    enabled: true
    architecture: standalone
    auth:
      enabled: false
