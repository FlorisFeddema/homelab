crowdsec:
  container_runtime: containerd


  lapi:
    dashboard:
      enabled: true

      image:
        repository: metabase/metabase
        pullPolicy: IfNotPresent
        tag: "v0.47.2"

      resources:
         limits:
           memory: 512Mi
         requests:
           cpu: 10m
           memory: 256Mi

      ingress:
        enabled: true
        annotations:
          nginx.ingress.kubernetes.io/backend-protocol: "HTTP"
          external-dns.alpha.kubernetes.io/hostname: crowdsec.cloud.feddema.dev
          external-dns.alpha.kubernetes.io/ttl: "120"
          ingress.kubernetes.io/rewrite-target: /
          cert-manager.io/cluster-issuer: letsencrypt-dns
        host: "crowdsec.cloud.feddema.dev"
        tls:
          - hosts:
              - crowdsec.cloud.feddema.dev
            secretName: "crowdsec-tls"

    resources:
      limits:
        memory: 256Mi
      requests:
        cpu: 50m
        memory: 128Mi

    persistentVolume:
      data:
        enabled: true
        size: 1Gi
      config:
        enabled: true
        size: 100Mi

    metrics:
      enabled: true
      serviceMonitor:
        enabled: true

  agent:
    acquisition:
      - namespace: "ingress-nginx"
        podName: "ingress-nginx-controller-*"
        program: "nginx"
        poll_without_inotify: false
    env:
      - name: COLLECTIONS
        value: "crowdsecurity/nginx"

    resources:
      limits:
        memory: 128Mi
      requests:
        cpu: 50m
        memory: 128Mi
    persistentVolume:
      config:
        enabled: true
        size: 100Mi

    metrics:
      enabled: true
      serviceMonitor:
        enabled: true
