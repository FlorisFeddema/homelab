gatus:
  ingress:
    enabled: true
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-dns
    hosts:
      - status.cloud.feddema.dev
    tls:
      - hosts:
          - status.cloud.feddema.dev
        secretName: status-tls

  resources: {}

  persistence:
    enabled: true
    size: 1Gi
    mountPath: /data
    accessModes:
      - ReadWriteOnce

  secrets: true

  env:
    POSTGRES_DB: app
    POSTGRES_HOST: gatus-data-rw.gatus
    POSTGRES_PORT: "5432"
    POSTGRES_USER: app

  serviceMonitor:
    enabled: true

  config:
    metrics: true
    storage:
      type: postgres
      path: "postgres://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}"
      caching: true
    alerting:
      telegram:
        token: ${TELEGRAM_TOKEN}
        id: ${TELEGRAM_ID}
    endpoints:

      # internal
      - name: argocd
        url: https://argocd.cloud.feddema.dev
        group: internal
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://10.96.0.99:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: adguard
        url: https://adguard.cloud.feddema.dev
        group: internal
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://10.96.0.99:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: authentik
        url: https://authentik.cloud.feddema.dev
        group: internal
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://10.96.0.99:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: hubble
        url: https://hubble.cloud.feddema.dev
        group: internal
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://10.96.0.99:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: emqx
        url: https://emqx.cloud.feddema.dev
        group: internal
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://10.96.0.99:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: gatus
        url: https://status.cloud.feddema.dev
        group: internal
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://10.96.0.99:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: grafana
        url: https://grafana.cloud.feddema.dev
        group: internal
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://10.96.0.99:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: homeassistant
        url: https://home.cloud.feddema.dev
        group: internal
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://10.96.0.99:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: minio
        url: https://minio.cloud.feddema.dev
        group: internal
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://10.96.0.99:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: nextcloud
        url: https://drive.cloud.feddema.dev
        group: internal
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://10.96.0.99:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: powerdnsadmin
        url: https://powerdns.cloud.feddema.dev
        group: internal
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://10.96.0.99:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: teslamate
        url: https://teslamate.cloud.feddema.dev
        group: internal
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://10.96.0.99:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: unifi
        url: https://unifi.cloud.feddema.dev
        group: internal
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://10.96.0.99:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: alertmanager
        url: https://alert.cloud.feddema.dev
        group: internal
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://10.96.0.99:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: vmalert
        url: https://vmalert.cloud.feddema.dev
        group: internal
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://10.96.0.99:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: zigbee2mqtt
        url: https://zigbee.cloud.feddema.dev
        group: internal
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://10.96.0.99:53'

        # external
      - name: argocd
        url: https://argocd.cloud.feddema.dev
        group: external
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://1.1.1.1:53'
      - name: adguard
        url: https://adguard.cloud.feddema.dev
        group: external
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://1.1.1.1:53'
      - name: authentik
        url: https://authentik.cloud.feddema.dev
        group: external
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://1.1.1.1:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: hubble
        url: https://hubble.cloud.feddema.dev
        group: external
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://1.1.1.1:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: emqx
        url: https://emqx.cloud.feddema.dev
        group: external
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://1.1.1.1:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: gatus
        url: https://status.cloud.feddema.dev
        group: external
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://1.1.1.1:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: grafana
        url: https://grafana.cloud.feddema.dev
        group: external
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://1.1.1.1:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: homeassistant
        url: https://home.cloud.feddema.dev
        group: external
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://1.1.1.1:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3
      - name: minio
        url: https://minio.cloud.feddema.dev
        group: external
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://1.1.1.1:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: nextcloud
        url: https://drive.cloud.feddema.dev
        group: external
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://1.1.1.1:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: powerdnsadmin
        url: https://powerdns.cloud.feddema.dev
        group: external
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://1.1.1.1:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: teslamate
        url: https://teslamate.cloud.feddema.dev
        group: external
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://1.1.1.1:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: unifi
        url: https://unifi.cloud.feddema.dev
        group: external
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://1.1.1.1:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: alertmanager
        url: https://alert.cloud.feddema.dev
        group: external
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://1.1.1.1:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: vmalert
        url: https://vmalert.cloud.feddema.dev
        group: external
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://1.1.1.1:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: zigbee2mqtt
        url: https://zigbee.cloud.feddema.dev
        group: external
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://1.1.1.1:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      - name: fail
        url: https://fail.cloud.feddema.dev
        group: external
        conditions:
          - '[STATUS] == 200'
        client:
          dns-resolver: 'udp://1.1.1.1:53'
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 3
            success-threshold: 3

      # dns servers
      - name: adguard-dns-loadbalancer
        url: 192.168.100.222
        group: dns
        dns:
          query-name: "example.com"
          query-type: "A"
        conditions:
          - "[BODY] == 93.184.216.34"
          - "[DNS_RCODE] == NOERROR"
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 1
            success-threshold: 3

      - name: powerdns-dns-loadbalancer
        url: 192.168.100.248
        group: dns
        dns:
          query-name: "example.com"
          query-type: "A"
        conditions:
          - "[BODY] == 93.184.216.34"
          - "[DNS_RCODE] == NOERROR"
        alerts:
          - type: telegram
            send-on-resolved: true
            failure-threshold: 1
            success-threshold: 3
